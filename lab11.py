#task 1

contacts = [
    {"ім'я": "Олег", "прізвище": "Іванов", "телефон": "123456789", "місто": "Львів"},
    {"ім'я": "Анна", "прізвище": "Петренко", "телефон": "987654321", "місто": "Київ"},
    {"ім'я": "Ірина", "прізвище": "Шевченко", "телефон": "555123456", "місто": "Львів"},
    {"ім'я": "Богдан", "прізвище": "Коваль", "телефон": "444987321", "місто": "Одеса"},
    {"ім'я": "Олена", "прізвище": "Сидоренко", "телефон": "333666999", "місто": "Харків"}
]

print("{:<10} {:<12} {:<12} {:<10}".format("Ім'я", "Прізвище", "Телефон", "Місто"))
for c in contacts:
    print("{:<10} {:<12} {:<12} {:<10}".format(c["ім'я"], c["прізвище"], c["телефон"], c["місто"]))



#task 2

contacts = [
    {"ім'я": "Олег", "прізвище": "Іванов", "телефон": "123456789", "місто": "Львів"},
    {"ім'я": "Анна", "прізвище": "Петренко", "телефон": "987654321", "місто": "Київ"},
    {"ім'я": "Ірина", "прізвище": "Шевченко", "телефон": "555123456", "місто": "Львів"},
    {"ім'я": "Богдан", "прізвище": "Коваль", "телефон": "444987321", "місто": "Одеса"},
    {"ім'я": "Олена", "прізвище": "Сидоренко", "телефон": "333666999", "місто": "Харків"}
]

def search_contacts(contacts, key):
    try:
        value = input(f"Введіть {key} для пошуку: ").strip()
        if not value:
            raise ValueError("Порожнє поле пошуку.")
        results = [c for c in contacts if c[key].lower() == value.lower()]
        if results:
            print("{:<10} {:<12} {:<12} {:<10}".format("Ім'я", "Прізвище", "Телефон", "Місто"))
            for c in results:
                print("{:<10} {:<12} {:<12} {:<10}".format(c["ім'я"], c["прізвище"], c["телефон"], c["місто"]))
        else:
            print("Контактів не знайдено.")
    except Exception as e:
        print("Помилка:", e)

print("Пошук за параметром: ім'я / прізвище / місто")
key = input("Введіть параметр пошуку: ").strip().lower()
if key in ["ім'я", "прізвище", "місто"]:
    search_contacts(contacts, key)
else:
    print("Невірний параметр.")
  

#task 3

from collections import Counter

contacts = [
    {"ім'я": "Олег", "прізвище": "Іванов", "телефон": "123456789", "місто": "Львів"},
    {"ім'я": "Анна", "прізвище": "Петренко", "телефон": "987654321", "місто": "Київ"},
    {"ім'я": "Ірина", "прізвище": "Шевченко", "телефон": "555123456", "місто": "Львів"},
    {"ім'я": "Богдан", "прізвище": "Коваль", "телефон": "444987321", "місто": "Одеса"},
    {"ім'я": "Олена", "прізвище": "Сидоренко", "телефон": "333666999", "місто": "Харків"}
]

def update_contact():
    phone = input("Введіть номер телефону для оновлення: ")
    for c in contacts:
        if c["телефон"] == phone:
            confirm = input("Оновити контакт? (так/ні): ")
            if confirm.lower() == "так":
                c["ім'я"] = input("Нове ім'я: ") or c["ім'я"]
                c["прізвище"] = input("Нове прізвище: ") or c["прізвище"]
                c["місто"] = input("Нове місто: ") or c["місто"]
                print("Контакт оновлено.")
            return
    print("Контакт не знайдено.")

def delete_contact():
    phone = input("Введіть номер телефону для видалення: ")
    for i, c in enumerate(contacts):
        if c["телефон"] == phone:
            confirm = input("Ви дійсно хочете видалити контакт? (так/ні): ")
            if confirm.lower() == "так":
                contacts.pop(i)
                print("Контакт видалено.")
            return
    print("Контакт не знайдено.")

def analyze():
    cities = {c["місто"] for c in contacts}
    print("Унікальні міста:", cities)

    city_count = Counter(c["місто"] for c in contacts)
    print("Кількість контактів по містах:")
    for city, count in city_count.items():
        print(f"{city}: {count}")

    if city_count:
        max_city = city_count.most_common(1)[0]
        print("Місто з найбільшою кількістю контактів:", max_city[0])

while True:
    print("\n1 - Оновити контакт\n2 - Видалити контакт\n3 - Аналітика\n0 - Вихід")
    choice = input("Ваш вибір: ")
    if choice == "1":
        update_contact()
    elif choice == "2":
        delete_contact()
    elif choice == "3":
        analyze()
    elif choice == "0":
        break
    else:
        print("Невірний вибір.")

